{% extends "base.html" %}
{% block body %}
<div class="container mt-4">
  <h3>Novo Scan</h3>
  <hr>
  <p><strong>Escolha o tipo de scan que pretende realizar:</strong></p>

  <form method="POST" action="{{ url_for('do_scan') }}" id="scanForm">
    <div class="form-group mb-3">
      <p><em>A ordem de scan determina a forma como os IPs são verificados e o tempo de execução do scan.</em></p>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="scan_type" id="scanAll" value="all" checked>
        <label class="form-check-label" for="scanAll">Toda a Rede</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="scan_type" id="scanRange" value="range">
        <label class="form-check-label" for="scanRange">Intervalo de IPs</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="scan_type" id="scanSpecific" value="specific">
        <label class="form-check-label" for="scanSpecific">IP Específico</label>
      </div>
    </div>

    <div class="form-group mb-3" id="ipInputGroup" style="display: none;">
      <label for="ip_range">Endereço IP:</label>
      <input type="text" class="form-control" id="ip_range" name="ip_range" placeholder="Ex: 192.168.1.10">
    </div>

    <div class="form-group mb-3" id="ipRangeGroup" style="display: none;">
      <label for="ip_start">Intervalo de IPs:</label>
      <div class="input-group">
        <input type="text" class="form-control" id="ip_start" name="ip_start" placeholder="IP inicial (Ex: 192.168.1.10)">
        <span class="input-group-text">até</span>
        <input type="text" class="form-control" id="ip_end" name="ip_end" placeholder="IP final (Ex: 192.168.1.20)">
      </div>
    </div>

    <hr>
    <div class="mb-3">
      <p><strong>Escolha as portas que pretende testar:</strong></p>
      <p><em>Separe um intervalo de portas com um traço (-) ou portas especificas com virgulas (,); deixe em branco para pesquisar todas as portas (1-65535). Fará com que o scan demore mais tempo.</em></p>
      <label class="form-label">Range de portas:</label>
      <input type="text" name="port_range" class="form-control" maxlength="20" placeholder="Ex: 20-80 ou 22,80,443">
    </div>
    <hr>

    <button type="submit" class="btn btn-primary" id="submitBtn">Iniciar Scan</button>

  </form>

<script>
  const scanAllRadio = document.getElementById('scanAll');
  const scanSpecificRadio = document.getElementById('scanSpecific');
  const scanRangeRadio = document.getElementById('scanRange');
  const ipInputGroup = document.getElementById('ipInputGroup');
  const ipRangeGroup = document.getElementById('ipRangeGroup');
  const ipInput = document.getElementById('ip_range');
  const form = document.getElementById('scanForm');
  const submitBtn = document.getElementById('submitBtn');
  const loadingSpinner = document.getElementById('loadingSpinner');

  // Mostra/oculta input IP conforme opção
  scanAllRadio.addEventListener('change', () => {
    ipInputGroup.style.display = 'none';
    ipRangeGroup.style.display = 'none';
  });

  scanSpecificRadio.addEventListener('change', () => {
    ipInputGroup.style.display = 'block';
    ipRangeGroup.style.display = 'none';
  });

  scanRangeRadio.addEventListener('change', () => {
    ipInputGroup.style.display = 'none';
    ipRangeGroup.style.display = 'block';
  });

</script>
{% endblock %}